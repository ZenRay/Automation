# Airflow 基础配置
AIRFLOW_UID=50000
MYSQL_ROOT_PASSWORD=airflow
MYSQL_DATABASE=airflow
MYSQL_USER=airflow
MYSQL_PASSWORD=airflow


# Ensure feishu domains bypass local proxy
NO_PROXY=localhost,127.0.0.1,open.feishu.cn,feishu.cn,service.cn-zhangjiakou.maxcompute.aliyun.com
no_proxy=localhost,127.0.0.1,open.feishu.cn,feishu.cn,service.cn-zhangjiakou.maxcompute.aliyun.com

# Airflow runtime and secrets (placeholders - replace before deploy)
AIRFLOW__DATABASE__SQL_ALCHEMY_CONN=mysql+pymysql://airflow:airflow@mysql:3306/airflow
# 生成一个新的 FERNET_KEY，避免加密问题
AIRFLOW__CORE__FERNET_KEY=I67LcGYLzktpMhESKUkcUfB1yGWL2UR_Qxre5Ljk5-8=
AIRFLOW__CORE__EXECUTOR=LocalExecutor
TZ=Asia/Shanghai
_PIP_ADDITIONAL_REQUIREMENTS=

# 数据库配置增强
AIRFLOW__DATABASE__LOAD_DEFAULT_CONNECTIONS=True
AIRFLOW__DATABASE__SQL_ALCHEMY_POOL_SIZE=5
AIRFLOW__DATABASE__SQL_ALCHEMY_POOL_RECYCLE=1800
AIRFLOW__DATABASE__SQL_ALCHEMY_MAX_OVERFLOW=10

# CSRF和安全配置
AIRFLOW__WEBSERVER__SECRET_KEY=a_strong_secret_key_for_csrf_protection
AIRFLOW__WEBSERVER__ENABLE_PROXY_FIX=True
AIRFLOW__WEBSERVER__COOKIE_SECURE=False
AIRFLOW__WEBSERVER__COOKIE_SAMESITE=Lax

# 性能和稳定性调优
AIRFLOW__SCHEDULER__MAX_THREADS=4
AIRFLOW__SCHEDULER__SCHEDULER_HEARTBEAT_SEC=10
AIRFLOW__SCHEDULER__PARSING_PROCESSES=2
AIRFLOW__SCHEDULER__MIN_FILE_PROCESS_INTERVAL=60
AIRFLOW__SCHEDULER__SCHEDULER_ZOMBIE_TASK_THRESHOLD=600
AIRFLOW__SCHEDULER__SCHEDULER_HEALTH_CHECK_THRESHOLD=120
AIRFLOW__CORE__PARALLELISM=8
AIRFLOW__CORE__DAG_CONCURRENCY=4
AIRFLOW__CORE__MAX_ACTIVE_RUNS_PER_DAG=1
